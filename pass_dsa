import random
import string

# Store passwords as a list of dictionaries
passwords = []

# Generate password
def generate_password(length, numbers=True, special_characters=True):
    letters = string.ascii_letters
    digits = string.digits
    special = string.punctuation

    characters = letters
    if numbers:
        characters += digits
    if special_characters:
        characters += special

    pwd = ""
    has_number = False
    has_special = False

    # Generate password of exact length
    while len(pwd) < length:
        new_char = random.choice(characters)
        pwd += new_char

        if new_char in digits:
            has_number = True
        if new_char in special:
            has_special = True

    # Ensure required characters are present
    if numbers and not has_number:
        pos = random.randint(0, length - 1)
        pwd = pwd[:pos] + random.choice(digits) + pwd[pos+1:]

    if special_characters and not has_special:
        pos = random.randint(0, length - 1)
        pwd = pwd[:pos] + random.choice(special) + pwd[pos+1:]

    return pwd

# Check password strength
def check_password_strength(password):
    length = len(password)
    has_number = any(char.isdigit() for char in password)
    has_special = any(char in string.punctuation for char in password)
    
    # Strongest
    if length >= 16 and has_number and has_special:
        return "Strongest"
    
    # Very Strong
    elif length >= 16 and (has_number or has_special):
        return "Very Strong"
    
    # Strong
    elif length >= 12 and has_number and has_special:
        return "Strong"
    
    # Moderate
    elif length >= 12 and (has_number or has_special):
        return "Moderate"
    elif length >= 8 and has_number and has_special:
        return "Moderate"
    
    # Weak
    else:
        return "Weak"



    
def delete_password(name_to_delete):
    if not passwords:
        print("No passwords to delete.")
        return
    else:
        found = False
        for i, entry in enumerate(passwords):
            if entry["name"].lower() == name_to_delete.lower():
                    passwords.pop(i)  # Remove the dictionary at index i
                    print(f"Password {name_to_delete} deleted successfully.\n")
            else:
                print("Deletion canceled.")
            found = True
            break

        if not found:
            print("No password found with that name.")

def search_password_by_name(name):
    for entry in passwords:
        if entry['name'].lower() == name.lower():
            return entry
    return None

def sort_passwords_by_strength():
    strength_order = {"Weak": 1, "Moderate": 2, "Strong": 3, "Very Strong": 4, "Strongest": 5}
    passwords.sort(key=lambda x: strength_order.get(x['strength'], 0))
    print("Passwords sorted by strength.")

    for i , entry in enumerate(passwords, start=1):
        print(f"{i}. Name: {entry['name']} Password: {entry['password']} Strength: {entry['strength']}")
        print("")


# Main menu
while True:
    print("\nPASSWORD MENU")
    print("1. Generate and Save Password")
    print("2. Check Password Strength")
    print("3. View Saved Passwords")
    print("4. Delete a Password")
    print("5. Search your unique password")
    print("6. Sort your passwords by strength")
    print("7. Exit")

    choice = input("Enter choice: ")
    
    if choice == "1":
        name = input("Enter password name (e.g. Gmail, Facebook): ")
        min_length = int(input("Enter minimum length: "))
        numbers = input("Include numbers (y/n)? ").lower() == "y"
        special = input("Include special characters (y/n)? ").lower() == "y"

        password = generate_password(min_length, numbers, special)
        passwords.append({"name": name, "password": password, "strength": check_password_strength(password)})
        print("-"*50)
        print(f"Password saved!\nName: {name}\nPassword: {password}\nStrength: {check_password_strength(password)}\n")

    elif choice == "2":
        password = input("Enter password to check: ")
        print("Password Strength:", check_password_strength(password))

    elif choice == "3":
        if not passwords:
            print("\nNo passwords saved.\n")
        else:
            print("\nSaved Passwords:")
            for i, entry in enumerate(passwords, start=1):
                print(f"{i}. Name: {entry['name']} Password: {entry['password']} Strength: {entry['strength']}")
                print("")

    elif choice == "4":
        name_to_delete = input("Enter password name to delete: ")
        
        delete_password(name_to_delete)

    elif choice == "5":
        name_to_search = input("do you want to search by (1)name code or by (2)password?: ")
        
        if name_to_search == "1":
            name_code = input("Enter password name_code to search: ")
            result = search_password_by_name(name_code)
            if result:
                print(f"Password Searched!\n Name: {result['name']}, Password: {result['password']} Strength: {result['strength']}")
            
        if name_to_search == "2":
            password_to_search = input("Enter password to search: ")
            found = False
            for entry in passwords:
                if entry["password"] == password_to_search:
                    print(f"Password Search!\n Name: {entry['name']}, Password: {entry['password']} Strength: {entry['strength']}")
                    found = True
                    break
            if not found:
                print("No password found with that password.")

    elif choice == "6":

        sort_passwords_by_strength()

    else:
        print("Invalid choice.")


